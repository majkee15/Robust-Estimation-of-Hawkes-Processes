%=======================================================================
%Author: Michael Mark
%Plotting script for a given portfolio 2-D contour plots
%(2015)
%=======================================================================
[inpar,params] = setpar();
T = 200;

pf = 5;
% contour plot parameters
p1 = 3;
p2 = 5;

%retreive data from pf
% pfolio = simdata1{pf}{1};
% covariates = simdata1{pf}{2};
% actions = simdata1{pf}{3};
% x0 = simdata1{pf}{4};
% x1 = simdata1{pf}{5};
% thetas = simdata1{pf}{6};
% lls = simdata1{pf};
pfolio = simdata1{pf}{1};
actions = simdata1{pf}{2};
x0 = simdata1{pf}{3};
x1 = simdata1{pf}{4};
thetas = simdata1{pf}{7}{1};

objfun = @(par) - loglike_portfolio(pfolio,T,actions,par,0);
objfunem = @(par) - Q(par,thetas(end,:),pfolio,actions,T);


label = string(pf);
labelmle = strcat(label," MLE ");
labelem = strcat(label," EM ");
range = [20*params(p1),20*params(p2)];

globalrange = [10,10];


[x,y,mles,ems] = setup_grid(p1,p2,globalrange,objfun,objfunem);

plot_loglike_3D(p1,p2,x,y,mles,objfun,x0,x1,0,labelmle)

plot2Dslice(p1,p2,x,y,mles,ems)
plot_loglike_3D(p1,p2,x,y,ems,objfunem,x0,thetas,0,labelem)

